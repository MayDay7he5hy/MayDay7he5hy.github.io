<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>LlamaIndex:让GPT学习私有知识  | Gao's Galaxy</title><meta name="author" content="Jensen Gao"><meta name="copyright" content="Jensen Gao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="LlamaIndex 总述LlamaIndex 是一个将大语言模型（Large Language Models, LLMs，后简称大模型）和外部数据连接在一起的工具。大模型依靠上下文学习（Context Learning）来推理知识，针对一个输入（或者是prompt），根据其输出结果。因此Prompt的质量很大程度上决定了输出结果的质量，因此提示工程（Prompt engineering）现在也很">
<meta property="og:type" content="article">
<meta property="og:title" content="LlamaIndex:让GPT学习私有知识 ">
<meta property="og:url" content="https://mayday7he5hy.github.io/2023/11/15/LlamaIndex-%E8%AE%A9GPT%E5%AD%A6%E4%B9%A0%E7%A7%81%E6%9C%89%E7%9F%A5%E8%AF%86/index.html">
<meta property="og:site_name" content="Gao&#39;s Galaxy">
<meta property="og:description" content="LlamaIndex 总述LlamaIndex 是一个将大语言模型（Large Language Models, LLMs，后简称大模型）和外部数据连接在一起的工具。大模型依靠上下文学习（Context Learning）来推理知识，针对一个输入（或者是prompt），根据其输出结果。因此Prompt的质量很大程度上决定了输出结果的质量，因此提示工程（Prompt engineering）现在也很">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://picst.sunbangyan.cn/2023/11/13/596bd1df3f12eb3f3e60115db0f25b0f.png">
<meta property="article:published_time" content="2023-11-15T08:32:34.000Z">
<meta property="article:modified_time" content="2023-11-15T07:13:53.356Z">
<meta property="article:author" content="Jensen Gao">
<meta property="article:tag" content="ChatGPT">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://picst.sunbangyan.cn/2023/11/13/596bd1df3f12eb3f3e60115db0f25b0f.png"><link rel="shortcut icon" href="/img/Jensen.png"><link rel="canonical" href="https://mayday7he5hy.github.io/2023/11/15/LlamaIndex-%E8%AE%A9GPT%E5%AD%A6%E4%B9%A0%E7%A7%81%E6%9C%89%E7%9F%A5%E8%AF%86/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'LlamaIndex:让GPT学习私有知识 ',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-11-15 15:13:53'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.0.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (true) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/cat.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://picst.sunbangyan.cn/2023/11/13/596bd1df3f12eb3f3e60115db0f25b0f.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Gao's Galaxy"><span class="site-name">Gao's Galaxy</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">LlamaIndex:让GPT学习私有知识 </h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-11-15T08:32:34.000Z" title="Created 2023-11-15 16:32:34">2023-11-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-11-15T07:13:53.356Z" title="Updated 2023-11-15 15:13:53">2023-11-15</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="LlamaIndex:让GPT学习私有知识 "><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="LlamaIndex-总述"><a href="#LlamaIndex-总述" class="headerlink" title="LlamaIndex 总述"></a>LlamaIndex 总述</h2><p>LlamaIndex 是一个将大语言模型（Large Language Models, LLMs，后简称大模型）和外部数据连接在一起的工具。大模型依靠上下文学习（Context Learning）来推理知识，针对一个输入（或者是prompt），根据其输出结果。因此Prompt的质量很大程度上决定了输出结果的质量，因此提示工程（Prompt engineering）现在也很受欢迎。目前大模型的输入输出长度因模型结构、显卡算力等因素影响，都有一个长度限制（以Token为单位，ChatGPT限制长度为4k个，GPT-4是32k等，Claude最新版有个100k的）。当我们外部知识的内容超过这个长度时，就无法同时将有效的信息传递给大模型。因此就诞生了 LlamaIndex 等项目。</p>
<p>假设有一个10w的外部数据，我们的原始输入Prompt长度为100，长度限制为4k，通过查询-检索的方式，我们能将最有效的信息提取集中在这4k的长度中，与Prompt一起送给大模型，从而让大模型得到更多的信息。此外，还能通过多轮对话的方式不断提纯外部数据，达到在有限的输入长度限制下，传达更多的信息给大模型。</p>
<h2 id="LLamaIndex的任务"><a href="#LLamaIndex的任务" class="headerlink" title="LLamaIndex的任务"></a>LLamaIndex的任务</h2><p>通过查询、检索的方式挖掘外部数据的信息，并将其传递给大模型，因此其主要由以下部分组成：</p>
<h3 id="1-数据连接器（Data-Connectors）"><a href="#1-数据连接器（Data-Connectors）" class="headerlink" title="1 数据连接器（Data Connectors）"></a>1 数据连接器（Data Connectors）</h3><p>数据连接器，读取文档的工具，最简单的就是读取本地文件。 LLamaIndex 的数据连接器包括：</p>
<ul>
<li>本地文件</li>
<li>Notion</li>
<li>Google 文档</li>
<li>Slack</li>
<li>Discord</li>
</ul>
<p>具体可参考Data Connectors。</p>
<h3 id="2-索引结构（Index-Structures）"><a href="#2-索引结构（Index-Structures）" class="headerlink" title="2 索引结构（Index Structures）"></a>2 索引结构（Index Structures）</h3><p>LlamaIndex 的核心其实就是 索引结构的集合，用户可以使用索引结构或基于这些索引结构自行建图。</p>
<h4 id="2-1-索引如何工作"><a href="#2-1-索引如何工作" class="headerlink" title="2.1 索引如何工作"></a>2.1 索引如何工作</h4><p>两个概念：</p>
<ul>
<li><strong>Node（节点）</strong>：即一段文本（Chunk of Text），LlamaIndex读取文档（documents）对象，并将其解析&#x2F;划分（parse&#x2F;chunk）成 Node 节点对象，构建起索引。</li>
<li><strong>Response Synthesis（回复合成）</strong>：LlamaIndex 进行检索节点并响应回复合成，不同的模式有不同的响应模式（比如向量查询、树形查询就不同），合成不同的扩充Prompt。</li>
</ul>
<p>索引方式包括：</p>
<ul>
<li>List Index：Node顺序存储，可用关键字过滤Node</li>
<li><strong>Vector Store Index</strong>：每个Node一个向量，查询的时候取top-k相似</li>
<li><strong>Tree Index</strong>：树形Node，从树根向叶子查询，可单边查询，或者双边查询合并。</li>
<li>Keyword Table Index：每个Node有很多个Keywords链接，通过查Keyword能查询对应Node。</li>
</ul>
<p>不同的索引方式决定了Query选择Node方式的不同。</p>
<p>回复合成方式包括：</p>
<ul>
<li>创建并提纯（Create and Refine)，即线性依次迭代；</li>
<li>树形总结（Tree Summarize）：自底向上，两两合并，最终合并成一个回复。</li>
</ul>
<h2 id="3-查询接口（Query-Inference）"><a href="#3-查询接口（Query-Inference）" class="headerlink" title="3 查询接口（Query Inference）"></a>3 查询接口（Query Inference）</h2><h3 id="3-1-LlamaIndex-使用模板"><a href="#3-1-LlamaIndex-使用模板" class="headerlink" title="3.1 LlamaIndex 使用模板"></a>3.1 LlamaIndex 使用模板</h3><p>LlamaIndex 常用使用模版：</p>
<ol>
<li>读取文档 (手动添加or通过Loader自动添加)；</li>
<li>将文档解析为Nodes；</li>
<li>构建索引（从文档or从Nodes，如果从文档，则对应函数内部会完成第2步的Node解析）</li>
<li>[可选，进阶] 在其他索引上构建索引，即多级索引结构</li>
<li>查询索引并对话大模型</li>
</ol>
<h4 id="3-1-1-读取文档"><a href="#3-1-1-读取文档" class="headerlink" title="3.1.1 读取文档"></a>3.1.1 读取文档</h4><p>使用data loaders读取</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> llama_index <span class="keyword">import</span> SimpleDirectoryReader</span><br><span class="line">​</span><br><span class="line"><span class="comment"># 从文件夹读取</span></span><br><span class="line">documents = SimpleDirectoryReader(input_dir=<span class="string">&#x27;./data&#x27;</span>).load_data()</span><br><span class="line">​</span><br><span class="line"><span class="comment"># 从指定文件读取，输入为List</span></span><br><span class="line">documents = SimpleDirectoryReader(input_files=[<span class="string">&#x27;./data/file.txt&#x27;</span>]).load_data()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>或者直接把自己的text改为document文档</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> llama_index <span class="keyword">import</span> Document</span><br><span class="line">​</span><br><span class="line"><span class="comment"># 直接从文本转换</span></span><br><span class="line">text_list = [text1, text2, ...]</span><br><span class="line">documents = [Document(t) <span class="keyword">for</span> t <span class="keyword">in</span> text_list]</span><br></pre></td></tr></table></figure>

<p>文档是轻量化的数据源容器，可以将文档：</p>
<ol>
<li>解析为 Node 对象 (见3.1.2)</li>
<li>直接喂入 Index (见3.1.3)，函数内部会完成转化Node过程</li>
</ol>
<h3 id="3-1-2-解析文档为Node"><a href="#3-1-2-解析文档为Node" class="headerlink" title="3.1.2 解析文档为Node"></a><strong>3.1.2 解析文档为Node</strong></h3><p>Node以数据 Chunks 的形式呈现文档，同时 Node 保留与其他 Node 和 索引结构 的关系。</p>
<p>直接解析文档</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> llama_index.node_parser <span class="keyword">import</span> SimpleNodeParser</span><br><span class="line">​</span><br><span class="line">parser = SimpleNodeParser()</span><br><span class="line">​</span><br><span class="line">nodes = parser.get_nodes_from_documents(documents)</span><br></pre></td></tr></table></figure>

<p>或者跳过 3.1.1 节文档创建操作，直接手动构建 Node</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> llama_index.data_structs.node_v2 <span class="keyword">import</span> Node, DocumentRelationship</span><br><span class="line">​</span><br><span class="line">node1 = Node(text=<span class="string">&quot;&lt;text_chunk&gt;&quot;</span>, doc_id=<span class="string">&quot;&lt;node_id&gt;&quot;</span>)</span><br><span class="line">node2 = Node(text=<span class="string">&quot;&lt;text_chunk&gt;&quot;</span>, doc_id=<span class="string">&quot;&lt;node_id&gt;&quot;</span>)</span><br><span class="line"><span class="comment"># set relationships</span></span><br><span class="line">node1.relationships[DocumentRelationship.NEXT] = node2.get_doc_id()</span><br><span class="line">node2.relationships[DocumentRelationship.PREVIOUS] = node1.get_doc_id()</span><br></pre></td></tr></table></figure>

<h3 id="3-1-3-Index-构建"><a href="#3-1-3-Index-构建" class="headerlink" title="3.1.3 Index 构建"></a><strong>3.1.3 Index 构建</strong></h3><p>可以直接将文档构建为 Index，这种简单构建的方式是在 Index 初始化时直接加载 文档</p>
<p>这种方式可以跳过 Node 构建（3.1.2）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> llama_index <span class="keyword">import</span> GPTSimpleVectorIndex</span><br><span class="line">​</span><br><span class="line">index = GPTSimpleVectorIndex.from_documents(documents)</span><br></pre></td></tr></table></figure>

<p>或者从 Node 构建 Index（3.1.2的续）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> llama_index <span class="keyword">import</span> GPTSimpleVectorIndex</span><br><span class="line">​</span><br><span class="line">index = GPTSimpleVectorIndex(nodes)</span><br></pre></td></tr></table></figure>

<h3 id="多个索引（Index）结构复用-Node"><a href="#多个索引（Index）结构复用-Node" class="headerlink" title="多个索引（Index）结构复用 Node"></a><strong>多个索引（Index）结构复用 Node</strong></h3><p>当想在多个索引中，复用一个 Node 时，可以通过定义 DocumentStore 结构，并在添加Nodes时指定 DocumentStore</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> gpt_index.docstore <span class="keyword">import</span> SimpleDocumentStore</span><br><span class="line">​</span><br><span class="line">docstore = SimpleDocumentStore()</span><br><span class="line">docstore.add_documents(nodes)</span><br><span class="line">​</span><br><span class="line">index1 = GPTSimpleVectorIndex(nodes, docstore=docstore)</span><br><span class="line">index2 = GPTListIndex(nodes, docstore=docstore)</span><br></pre></td></tr></table></figure>

<p>如果没指定 docstore，则会在创建 Index 时隐式创建一个。</p>
<h3 id="索引中插入文档"><a href="#索引中插入文档" class="headerlink" title="索引中插入文档"></a><strong>索引中插入文档</strong></h3><p>也可以将文档插入到索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> llama_index <span class="keyword">import</span> GPTSimpleVectorIndex</span><br><span class="line">​</span><br><span class="line">index = GPTSimpleVectorIndex([])</span><br><span class="line"><span class="keyword">for</span> doc <span class="keyword">in</span> documents:</span><br><span class="line">    index.insert(doc)</span><br></pre></td></tr></table></figure>

<h3 id="自定义-LLMs"><a href="#自定义-LLMs" class="headerlink" title="自定义 LLMs"></a><strong>自定义 LLMs</strong></h3><p>默认情况，llamaIndex 使用<code>text-davinci-003</code>，也可以用别的构建 Index</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> llama_index <span class="keyword">import</span> LLMPredictor, GPTSimpleVectorIndex, PromptHelper, ServiceContext</span><br><span class="line"><span class="keyword">from</span> langchain <span class="keyword">import</span> OpenAI</span><br><span class="line">​</span><br><span class="line">...</span><br><span class="line">​</span><br><span class="line"><span class="comment"># define LLM</span></span><br><span class="line">llm_predictor = LLMPredictor(llm=OpenAI(temperature=<span class="number">0</span>, model_name=<span class="string">&quot;text-davinci-003&quot;</span>))</span><br><span class="line">​</span><br><span class="line"><span class="comment"># define prompt helper</span></span><br><span class="line"><span class="comment"># set maximum input size</span></span><br><span class="line">max_input_size = <span class="number">4096</span></span><br><span class="line"><span class="comment"># set number of output tokens</span></span><br><span class="line">num_output = <span class="number">256</span></span><br><span class="line"><span class="comment"># set maximum chunk overlap</span></span><br><span class="line">max_chunk_overlap = <span class="number">20</span></span><br><span class="line">prompt_helper = PromptHelper(max_input_size, num_output, max_chunk_overlap)</span><br><span class="line">​</span><br><span class="line">service_context = ServiceContext.from_defaults(llm_predictor=llm_predictor, prompt_helper=prompt_helper)</span><br><span class="line">​</span><br><span class="line">index = GPTSimpleVectorIndex.from_documents(</span><br><span class="line">    documents, service_context=service_context</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="自定义-Prompts"><a href="#自定义-Prompts" class="headerlink" title="自定义 Prompts"></a><strong>自定义 Prompts</strong></h3><p>基于使用的Index，llamaIndex 会使用默认的 prompt 模板进行构建 Index（插入 or 创建）, 也可以自定义<a href="https://link.zhihu.com/?target=https://gpt-index.readthedocs.io/en/latest/how_to/customization/custom_prompts.html">link</a>。</p>
<h3 id="自定义-Embeddings"><a href="#自定义-Embeddings" class="headerlink" title="自定义 Embeddings"></a><strong>自定义 Embeddings</strong></h3><p>对于自定义 embedding 的模型，也可以自定义 embedding <a href="https://link.zhihu.com/?target=https://gpt-index.readthedocs.io/en/latest/how_to/customization/embeddings.html%23custom-embeddings">link</a>。</p>
<h3 id="消费-Predictor"><a href="#消费-Predictor" class="headerlink" title="消费 Predictor"></a><strong>消费 Predictor</strong></h3><p>创建 Index、Insert 和 Query 时也会消耗 tokens，<a href="https://link.zhihu.com/?target=https://gpt-index.readthedocs.io/en/latest/how_to/analysis/cost_analysis.html">link</a>。</p>
<h3 id="存储-Index-下次用"><a href="#存储-Index-下次用" class="headerlink" title="存储 Index 下次用"></a><strong>存储 Index 下次用</strong></h3><pre><code>import os.path as osp
index_file = &quot;data/indices/index.json&quot;
if not osp.isfile(index_file):
    # 判断是否存在，不存在则创建
    index = GPTSimpleVectorIndex.from_documents(documents)
    index.save_to_disk(index_file, encoding=&#39;utf-8&#39;)
else:
    # 存在则 load
    index = GPTSimpleVectorIndex.load_from_disk(index_file)
</code></pre>
<h3 id="3-1-4-可选，进阶-在索引上继续构建索引"><a href="#3-1-4-可选，进阶-在索引上继续构建索引" class="headerlink" title="3.1.4 [可选，进阶] 在索引上继续构建索引"></a><strong>3.1.4 [可选，进阶] 在索引上继续构建索引</strong></h3><p>可参考<a href="https://link.zhihu.com/?target=https://gpt-index.readthedocs.io/en/latest/guides/primer/usage_pattern.html">官方教程</a>第4节；</p>
<h4 id="3-1-5-查询索引"><a href="#3-1-5-查询索引" class="headerlink" title="3.1.5 查询索引"></a>3.1.5 查询索引</h4><p>默认使用索引为 问答形式，可以不指定额外的参数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">response = index.query(<span class="string">&quot;What did the author do growing up?&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(response)</span><br><span class="line"></span><br><span class="line">response = index.query(<span class="string">&quot;Write an email to the user given their background information.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure>

<h2 id="代码简述"><a href="#代码简述" class="headerlink" title="代码简述"></a>代码简述</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> llama_index <span class="keyword">import</span> GPTSimpleVectorIndex, SimpleDirectoryReader</span><br><span class="line"><span class="keyword">from</span> llama_index <span class="keyword">import</span> (</span><br><span class="line">    GPTKeywordTableIndex,</span><br><span class="line">    SimpleDirectoryReader,</span><br><span class="line">    LLMPredictor,</span><br><span class="line">    ServiceContext</span><br><span class="line">)</span><br><span class="line"><span class="keyword">from</span> langchain <span class="keyword">import</span> OpenAI</span><br><span class="line">​</span><br><span class="line">​</span><br><span class="line">documents = SimpleDirectoryReader(<span class="string">&#x27;data&#x27;</span>).load_data()</span><br><span class="line">​</span><br><span class="line">os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>] = <span class="string">&#x27;设置自己的Key&#x27;</span></span><br><span class="line">​</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">直接这样可以运行</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># GPT Index</span></span><br><span class="line">index = GPTSimpleVectorIndex.from_documents(documents)</span><br><span class="line">response = index.query(<span class="string">&quot;What did the author do growing up?&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(response)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Response(response=&#x27;\n\nGrowing up, the author wrote short stories, programmed on an IBM 1401, wrote simple games and a word processor on a TRS-80, studied philosophy in college, learned Lisp, reverse-engineered SHRDLU, wrote a book about Lisp hacking, took art classes at Harvard, and painted still lives in his bedroom at night. He also attended an Accademia where he painted still lives on leftover scraps of ...</span></span><br><span class="line"><span class="string">tover scraps of canvas, which was all I could afford at the time. Painting still lives is different&#x27;, doc_id=&#x27;5ba2ade0-0b8c-4ef7-906d-1ca434606232&#x27;, embedding=None, doc_hash=&#x27;6a5d8e0ae90c969305717b2ba8d4bc6296336ef595104d8d474abfff99ed64e3&#x27;, extra_info=None, node_info=&#123;&#x27;start&#x27;: 0, &#x27;end&#x27;: 15198&#125;, relationships=&#123;&lt;DocumentRelationship.SOURCE: &#x27;1&#x27;&gt;: &#x27;5c89fa41-6bf8-4181-a9fa-57b66c3aecc1&#x27;, &lt;DocumentRelationship.NEXT: &#x27;3&#x27;&gt;: &#x27;a6444b3f-5fc5-4593-8b3d-f04ffb39a6a6&#x27;&#125;), score=0.8242781513247005)], extra_info=&#123;&#x27;5ba2ade0-0b8c-4ef7-906d-1ca434606232&#x27;: None&#125;)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">​</span><br><span class="line">​</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">自定义模型</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># # define LLM</span></span><br><span class="line">llm_predictor = LLMPredictor(llm=OpenAI(temperature=<span class="number">0</span>, model_name=<span class="string">&quot;text-davinci-002&quot;</span>))</span><br><span class="line">service_context = ServiceContext.from_defaults(llm_predictor=llm_predictor)</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># build index</span></span><br><span class="line">index = GPTKeywordTableIndex.from_documents(documents, service_context=service_context)</span><br><span class="line">​</span><br><span class="line">response = index.query(<span class="string">&quot;What did the author do growing up?&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://MayDay7he5hy.github.io">Jensen Gao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://mayday7he5hy.github.io/2023/11/15/LlamaIndex-%E8%AE%A9GPT%E5%AD%A6%E4%B9%A0%E7%A7%81%E6%9C%89%E7%9F%A5%E8%AF%86/">https://mayday7he5hy.github.io/2023/11/15/LlamaIndex-%E8%AE%A9GPT%E5%AD%A6%E4%B9%A0%E7%A7%81%E6%9C%89%E7%9F%A5%E8%AF%86/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ChatGPT/">ChatGPT</a></div><div class="post_share"><div class="social-share" data-image="https://picst.sunbangyan.cn/2023/11/13/596bd1df3f12eb3f3e60115db0f25b0f.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/11/16/What-is-Vector-Database/" title="What is Vector Database"><img class="cover" src="https://picst.sunbangyan.cn/2023/11/15/131a5a20075f0bd4efa0391e62965b14.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">What is Vector Database</div></div></a></div><div class="next-post pull-right"><a href="/2023/11/13/ChatGPT-Update/" title="ChatGPT Update"><img class="cover" src="https://picst.sunbangyan.cn/2023/11/13/0f5604f5cf1333b39e73767ed975262e.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next</div><div class="next_info">ChatGPT Update</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2023/02/12/How-to-use-ChatGPT/" title="chatgpt使用教程"><img class="cover" src="https://luckyblob.oss-cn-shanghai.aliyuncs.com/postimgs/image-20230212211052395.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-12</div><div class="title">chatgpt使用教程</div></div></a></div><div><a href="/2023/11/08/GPT-%E8%BF%91%E7%AB%AF%E7%AD%96%E7%95%A5%E4%BC%98%E5%8C%96%EF%BC%88PPO%EF%BC%89/" title="GPT-原理"><img class="cover" src="https://picst.sunbangyan.cn/2023/11/08/2b1f76a3e591c1e272a8c4e22137cf09.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-08</div><div class="title">GPT-原理</div></div></a></div><div><a href="/2023/11/09/ChatGPT-%E6%A1%8C%E9%9D%A2%E7%89%88%E4%BD%BF%E7%94%A8/" title="ChatGPT 桌面版使用"><img class="cover" src="https://picss.sunbangyan.cn/2023/11/09/1c626f70315f6c390033c0d24bbca7fc.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-09</div><div class="title">ChatGPT 桌面版使用</div></div></a></div><div><a href="/2023/11/13/ChatGPT-Update/" title="ChatGPT Update"><img class="cover" src="https://picst.sunbangyan.cn/2023/11/13/0f5604f5cf1333b39e73767ed975262e.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-13</div><div class="title">ChatGPT Update</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/cat.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jensen Gao</div><div class="author-info__description">Software Engineering student at Tongji University with dreams of pursuing a Master's in the U.S</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/MayDay7he5hy"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/MayDay7he5hy" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="/gaojuncheng020505@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Welcome to my digital space! I'm thrilled you've stopped by. Here, you'll find a collection of my thoughts, stories, and insights, all curated with the hope of resonating with you.</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#LlamaIndex-%E6%80%BB%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">LlamaIndex 总述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LLamaIndex%E7%9A%84%E4%BB%BB%E5%8A%A1"><span class="toc-number">2.</span> <span class="toc-text">LLamaIndex的任务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E8%BF%9E%E6%8E%A5%E5%99%A8%EF%BC%88Data-Connectors%EF%BC%89"><span class="toc-number">2.1.</span> <span class="toc-text">1 数据连接器（Data Connectors）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%B4%A2%E5%BC%95%E7%BB%93%E6%9E%84%EF%BC%88Index-Structures%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">2 索引结构（Index Structures）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E7%B4%A2%E5%BC%95%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.1 索引如何工作</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%9F%A5%E8%AF%A2%E6%8E%A5%E5%8F%A3%EF%BC%88Query-Inference%EF%BC%89"><span class="toc-number">3.</span> <span class="toc-text">3 查询接口（Query Inference）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-LlamaIndex-%E4%BD%BF%E7%94%A8%E6%A8%A1%E6%9D%BF"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 LlamaIndex 使用模板</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-%E8%AF%BB%E5%8F%96%E6%96%87%E6%A1%A3"><span class="toc-number">3.1.1.</span> <span class="toc-text">3.1.1 读取文档</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-2-%E8%A7%A3%E6%9E%90%E6%96%87%E6%A1%A3%E4%B8%BANode"><span class="toc-number">3.2.</span> <span class="toc-text">3.1.2 解析文档为Node</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-3-Index-%E6%9E%84%E5%BB%BA"><span class="toc-number">3.3.</span> <span class="toc-text">3.1.3 Index 构建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AA%E7%B4%A2%E5%BC%95%EF%BC%88Index%EF%BC%89%E7%BB%93%E6%9E%84%E5%A4%8D%E7%94%A8-Node"><span class="toc-number">3.4.</span> <span class="toc-text">多个索引（Index）结构复用 Node</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E4%B8%AD%E6%8F%92%E5%85%A5%E6%96%87%E6%A1%A3"><span class="toc-number">3.5.</span> <span class="toc-text">索引中插入文档</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89-LLMs"><span class="toc-number">3.6.</span> <span class="toc-text">自定义 LLMs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89-Prompts"><span class="toc-number">3.7.</span> <span class="toc-text">自定义 Prompts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89-Embeddings"><span class="toc-number">3.8.</span> <span class="toc-text">自定义 Embeddings</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B6%88%E8%B4%B9-Predictor"><span class="toc-number">3.9.</span> <span class="toc-text">消费 Predictor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8-Index-%E4%B8%8B%E6%AC%A1%E7%94%A8"><span class="toc-number">3.10.</span> <span class="toc-text">存储 Index 下次用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-4-%E5%8F%AF%E9%80%89%EF%BC%8C%E8%BF%9B%E9%98%B6-%E5%9C%A8%E7%B4%A2%E5%BC%95%E4%B8%8A%E7%BB%A7%E7%BB%AD%E6%9E%84%E5%BB%BA%E7%B4%A2%E5%BC%95"><span class="toc-number">3.11.</span> <span class="toc-text">3.1.4 [可选，进阶] 在索引上继续构建索引</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-5-%E6%9F%A5%E8%AF%A2%E7%B4%A2%E5%BC%95"><span class="toc-number">3.11.1.</span> <span class="toc-text">3.1.5 查询索引</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E7%AE%80%E8%BF%B0"><span class="toc-number">4.</span> <span class="toc-text">代码简述</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/11/16/What-is-Vector-Database/" title="What is Vector Database"><img src="https://picst.sunbangyan.cn/2023/11/15/131a5a20075f0bd4efa0391e62965b14.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="What is Vector Database"/></a><div class="content"><a class="title" href="/2023/11/16/What-is-Vector-Database/" title="What is Vector Database">What is Vector Database</a><time datetime="2023-11-16T07:09:29.000Z" title="Created 2023-11-16 15:09:29">2023-11-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/15/LlamaIndex-%E8%AE%A9GPT%E5%AD%A6%E4%B9%A0%E7%A7%81%E6%9C%89%E7%9F%A5%E8%AF%86/" title="LlamaIndex:让GPT学习私有知识 "><img src="https://picst.sunbangyan.cn/2023/11/13/596bd1df3f12eb3f3e60115db0f25b0f.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LlamaIndex:让GPT学习私有知识 "/></a><div class="content"><a class="title" href="/2023/11/15/LlamaIndex-%E8%AE%A9GPT%E5%AD%A6%E4%B9%A0%E7%A7%81%E6%9C%89%E7%9F%A5%E8%AF%86/" title="LlamaIndex:让GPT学习私有知识 ">LlamaIndex:让GPT学习私有知识 </a><time datetime="2023-11-15T08:32:34.000Z" title="Created 2023-11-15 16:32:34">2023-11-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/13/ChatGPT-Update/" title="ChatGPT Update"><img src="https://picst.sunbangyan.cn/2023/11/13/0f5604f5cf1333b39e73767ed975262e.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ChatGPT Update"/></a><div class="content"><a class="title" href="/2023/11/13/ChatGPT-Update/" title="ChatGPT Update">ChatGPT Update</a><time datetime="2023-11-13T03:03:25.000Z" title="Created 2023-11-13 11:03:25">2023-11-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/10/k8s%E5%88%9D%E4%BD%93%E9%AA%8C-minikube%E7%AA%81%E7%A0%B4%E9%9A%94%E6%96%AD%E8%AE%BF%E9%97%AE%E9%99%90%E5%88%B6/" title="k8s初体验-minikube突破隔断访问限制(以nginx为例)"><img src="https://luckyblob.oss-cn-shanghai.aliyuncs.com/postimgs/image-20230310101006602.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="k8s初体验-minikube突破隔断访问限制(以nginx为例)"/></a><div class="content"><a class="title" href="/2023/11/10/k8s%E5%88%9D%E4%BD%93%E9%AA%8C-minikube%E7%AA%81%E7%A0%B4%E9%9A%94%E6%96%AD%E8%AE%BF%E9%97%AE%E9%99%90%E5%88%B6/" title="k8s初体验-minikube突破隔断访问限制(以nginx为例)">k8s初体验-minikube突破隔断访问限制(以nginx为例)</a><time datetime="2023-11-10T01:08:25.000Z" title="Created 2023-11-10 09:08:25">2023-11-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/09/k8s%E5%88%9D%E4%BD%93%E9%AA%8C-nginx-pod-%E9%83%A8%E7%BD%B2%E5%B9%B6%E8%AE%BF%E9%97%AE/" title="k8s初体验---nginx(pod)部署并访问"><img src="https://luckyblob.oss-cn-shanghai.aliyuncs.com/postimgs/image-20230115202715679.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="k8s初体验---nginx(pod)部署并访问"/></a><div class="content"><a class="title" href="/2023/11/09/k8s%E5%88%9D%E4%BD%93%E9%AA%8C-nginx-pod-%E9%83%A8%E7%BD%B2%E5%B9%B6%E8%AE%BF%E9%97%AE/" title="k8s初体验---nginx(pod)部署并访问">k8s初体验---nginx(pod)部署并访问</a><time datetime="2023-11-09T10:26:19.000Z" title="Created 2023-11-09 18:26:19">2023-11-09</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://picst.sunbangyan.cn/2023/11/13/596bd1df3f12eb3f3e60115db0f25b0f.png')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By Jensen Gao</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to Jensen's <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="60198" data-server="netease" data-type="playlist" data-listmaxheight="340px" data-fixed="true" data-autoplay="true"> </div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>